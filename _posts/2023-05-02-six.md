---
layout: single
title:  "고급 매핑"
---

![.](https://velog.velcdn.com/images/jhp1115/post/f8145848-e8b5-4372-ade5-3c75e9216527/jpa.png)

## 상속관계 매핑
 - 관계형 데베는 상속관계가 없다.
 - 상속관계 매핑은 객체의 상속과 구조와 DB의 슈퍼타입, 서브타입 관계를 매핑한다.
 - 조인 전략, 단일테이블 전략, 구현클래스마다 테이블 전략 으로 나눠진다.

 > @Inheritance: 부모클래스에 사용해야하고 매핑 전략 지정위해 타입 설정해준다.  
 > @DiscriminatorColumn: 부모클래스에 써서 구분 컬럼을 지정한다. 저장된 자식테이블 구분할 수 있으며 ,기본값은 DTYPE이다.
 > @DiscriminatorValue: 엔티티를 저장할 때 구분 컬럼에 입력할 값을 지정한다. 기본값은 엔티티의 이름이다.
 
 ---
 ### 조인전략
 ![.](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fdu6vfU%2FbtrqMQkdVg6%2FYkmiILj8XhB04vc6xbZ420%2Fimg.png)  
- 각각 테이블로 변환하고 자식 테이블이 부모 테이블의 기본키를 받아서 기본키 + 외래키로 사용하는 전략이다.   
- 테이블은 타입의 개념이 없으므로 DTYPE 컬럼과 같이 타입을 구분하는 컬럼 필요하다.  

 ### 장점
 -테이블이 정규화된다.  
 -외래 키 참조 무결성 제약 조건을 활용할 수 있다.  
 -저장 공간을 효율적으로 사용한다.


>외래키 참조 무결성 제약 조건  
외래키 값은 NULL이거나 참조 테이블의 기본키 값과 동일해야 한다는 것이다.
즉 참조할 수 없는 외래키 값을 가질 수 없다는 것이다.
ex) 수강 테이블의 학번 속성에는 학생 테이블의 학번 속성에 없는 값을 입력할 수 없다.


단점
조회할 때 조인이 많이 사용되므로 잘못 이용하면 성능이 저하될 여지가 있다.
조회 쿼리가 복잡하다.
데이터를 등록할 때 INSERT SQL을 두 번 실행한다.

-단일테이블 전략: 테이블 하나에 데이터 다 집어넣는 전략
     -구분 컬럼을 통해서 어떤 자식 데이터가 저장되있는지 구분하며, 조회할때 조인 사용하지않는다.

장점
조인이 필요 없으므로 일반적으로 조회 성능이 빠르다.
조회 쿼리가 단순하다.

단점
자식 엔티티가 매핑한 컬럼이 모두 null을 허용해야 한다.
단일 테이블에 모든 것을 저장하므로 테이블이 커질 수 있다. 그러므로 상황에 따라서는 조회 성능이 오히려 느려질 수 있다.
 
구현클래스마다 테이블 전략: 자식 엔티티마다 테이블을 만들며, 자식 테이블 각각에 필요한 컬럼은 모두 있다.
-구분 컬럼을 사용하지 않는다는 특징이 있고, 일반적으로 해당 전략은 사용하지 않는다.

@Inheritance의 문제점
-서브 타입클래스만 따로 조회할수가 없다.
Hibernate가 항상 EAGER 전략을 사용하기 때문이다.


@MappedSuperclass
-테이블과 관계 없고, 단순히 엔티티가 공통으로 사용하는 매핑 정보를 모으는 역할
-상속관계 매핑x, 엔티티x, 테이블과 매핑x
-조회,검색 불가, 추상 클래스 권장
